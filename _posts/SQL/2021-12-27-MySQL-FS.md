--- 
layout: post
title: "[SQL/MySQL] MySQL 기초"
author: Woohyun Kwon
categories: SQL
tags: [SQL, MySQL]
---

#### 테이블 구조 참조하기 DESC

`DESC 테이블명;`

#### SELECT
- 테이블 데이터 읽어오기 `SELECT * FROM 테이블명;`

#### WHERE
- 검색 조건 지정하기 
`SELECT 열1, 열2 FROM 테이블명 WHERE 조건식`
    - 수치형: 1, 100, -3.3
    - 문자형: "ABC", "문자형"
    - 시간형: '2021-12-27', '2099-12-31 23:59:59'
    - NULL: IS NULL / IS NOT NULL

- 조건 조합하기 AND, OR, NOR
    - AND는 OR에 비해 우선 순위가 높다
    - ex) SELECT * FROM sample WHERE a=1 OR a=2 AND b=1 OR b=2
        == SELECT * FROM sample WHERE a=1 OR (a=2 AND b=1) OR b=2

- 패턴 매칭(부분 검색) LIKE

    | no | text |
    |----|------|
    | 1 | "=" 연산자로 검색하는 경우 셀의 데이터 값이 완전히 동일한지 비교한다|
    | 2 | 반면, LIKE 연산자는 일부분을 비교할 수 있다|
    | 3 | "%"는 임의의 문자열
    | 4 | "_"는 임의의 문자 하나
    | 5 | "*"는 LIKE 에서 사용 불가

    `SELECT * FROM sample WHERE text LIKE '%임의%';`

    | no | text |
    |----|------|
    | 3 | "%"는 임의의 문자열
    | 4 | "_"는 임의의 문자 하나

- 정렬 ORDER BY
    - 오름차순: `SELECT 열명 FROM 테이블명 (WHERE 조건식) ORDER BY 열명 (ASC)`
    - 내림차순: `SELECT 열명 FROM 테이블명 (WHERE 조건식) ORDER BY 열명 DESC`
    - 복수 열 정렬: `SELECT 열명 FROM 테이블명 (WHERE 조건식) ORDER BY 열1 ASC/DESC, 열2 ASC/DESC, ...`
    - NULL값 포함: NULL값을 포함하는 행은 가장 먼저 표시되거나(ASC) 가장 나중에 표시된다(DESC)

- 결과 행 제한하기 LIMIT `SELECT 열명 FROM 테이블명 (WHERE 조건식 ORDER BY 열명) LIMIT 행수 [OFFSET 시작행];`
    - 표준 SQL 아님. MySQL과 PostgreSQL에서 사용 가능

- 수치 연산
    - 산술연산: +, -, *, /, %, MOD
    - NULL 값을 연산하면 결과는 NULL이 된다.
    - 함수: `함수명 (인수1, 인수2, ...)`
    - 반올림 ROUND: `SELECT amount, ROUND(amount, 1) FROM sample;`
    - ex) 새로운 열(price * quantity) 만들고 열명(amount) 정하기 `SELECT *, price * quantity AS amount FROM sample;`

        | no | price | quantity | amount(=price*quantity) |
        |----|-------|----------|-------------------------|
        | 1  |  100  |      10  |                 1000    |
        | 2  |  230  |      24  | 5520 |
        | 3  | 1200  |       1  | 1200 |

### 문자열 연산

| 연산자 | 연산 | 데이터베이스 |
|--------|-----|---|
| + | 문자열 결합 | SQL Server |
| \|\| | 문자열 결합 | Oracle, DB2, PostgreSQL|
| CONCAT | 문자열 결합 | MySQL |

문자열 결함 CONCAT()

| no | price | quantity | unit |
|----|-------|----------|------|
| 1  |  100  |      10  | 개   |
| 2  |  230  |      24  | 캔   |
| 3  | 1200  |       1  | 장   |

'SELECT CONCAT(quantity, unit) FROM sample;`

| CONCAT(quantity, unit) |
|------------------------|
| 10개 |
| 24캔 |
| 1장 |

#### SUBSTRING

문자열의 일부분을 계산해서 반환해주는 함수.

    앞 4자리(년) 추출
    SUBSTRING('20140125001',1,4) -> '2014'

    5째 자리부터 2자리(월) 추출
    SUBSTRING('20140125001', 5, 2) -> '01'

#### TRIM

문자열의 앞뒤로 여분의 스페이스가 있을 경우 이를 제거해주는 함수로 문자열 도중에 존재하는 스페이스는 제거되지 않는다.

    TRIM('ABC    ') -> ABC

#### CHARACTER_LENGTH

함수의 길이를 계산해 돌려주는 함수

| 문자세트 | 문자수 | 바이트 수 |
|---------|--------|----------|
| EUC_KR | 12 | 19 |
| UTF-8 | 12 | 26 |

### 날짜 연산

- 시스템 날짜 확인하기
    `SELECT CURRENT_TIMESTAMP;`

- 날짜 서식 바꾸기
    `TO_DATE('2021/12/27', 'YYYY/MM/DD')`

- 날짜 변경하기
    ```MySQL
    <날짜를 연산해 시스템 날짜의 1일 후를 검색>
    SELECT CURRENT_DATE + INTERVAL 1 DAY; -> 2021-12-28
    ```

### CASE

RDBMS에 기본적으로 내장되어있는 함수가 아닌 사용자 지정 함수를 작성하고 싶을 때 사용한다

```MySQL
<기본형>
CASE WHEN 조건식1 THEN 식1
    [WHEN 조건식2 THEN 식2]
    [ELSE 식3]
END
```

```MySQL
<성별 코드 변환하기(검색 CASE)>
SELECT a AS "코드",
CASE
    WHEN a = 1 THEN '남자'
    WHEN a = 2 THEN '여자'
    ELSE '미지정'
END AS "성별" FROM sample;
```

- ELSE를 생략하면 ELSE NULL이 된다

### COALESCE

여러 개의 인수를 지정할 수 있고, 주어진 인수 가운데 NULL이 아닌 값에 대해 가장 먼저 지정된 인수의 값을 반환한다.

    SELECT a, COALESCE(a,0) FROM sample;



## REFERENCES
- SQL첫걸음
- [MySQL 데이터베이스 한번에 끝내기](https://www.youtube.com/watch?v=vgIc4ctNFbc&list=WL&index=39&t=370s)